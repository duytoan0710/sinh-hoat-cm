
<div class="animate-fade-in">
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-bold text-gray-900">Biên bản Sinh hoạt tổ chuyên môn - Khối 4, 5</h2>
    <div class="flex items-center gap-4">
      <button type="button" (click)="viewClicked.emit()" class="rounded-md bg-white px-3.5 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">
        Xem biên bản
      </button>
      <button type="button" (click)="downloadClicked.emit()" class="rounded-md bg-white px-3.5 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
        </svg>
        Tải file PDF
      </button>
    </div>
  </div>
  <form [formGroup]="meetingForm" (ngSubmit)="onSubmit()" class="space-y-4">

    <!-- Section: Attendees -->
    <div class="rounded-lg bg-white shadow-sm overflow-hidden border">
       <button type="button" (click)="toggleSection('attendees')" class="w-full flex justify-between items-center p-3 text-left bg-gradient-to-r from-indigo-50 via-purple-50 to-pink-50 hover:from-indigo-100 transition-colors focus:outline-none">
        <h3 class="text-sm font-bold uppercase tracking-wider text-indigo-800">I. Thành phần tham dự</h3>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform duration-300 text-indigo-600" [class.rotate-180]="!sections().attendees" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
      </button>
      @if (sections().attendees) {
        <div class="p-6 border-t animate-fade-in-down grid grid-cols-1 sm:grid-cols-3 gap-6">
          <div>
            <label for="meetingDate-g45" class="block text-sm font-medium leading-6 text-gray-900">Ngày họp</label>
            <input type="date" id="meetingDate-g45" formControlName="meetingDate" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300">
          </div>
          <div>
            <label for="meetingTime-g45" class="block text-sm font-medium leading-6 text-gray-900">Giờ họp</label>
            <input type="time" id="meetingTime-g45" formControlName="meetingTime" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300">
          </div>
          <div>
            <label for="location-g45" class="block text-sm font-medium leading-6 text-gray-900">Địa điểm</label>
            <input type="text" id="location-g45" formControlName="location" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300">
          </div>
          <div>
            <label for="bghRepresentative-g45" class="block text-sm font-medium leading-6 text-gray-900">Đại diện BGH</label>
            <select id="bghRepresentative-g45" formControlName="bghRepresentative" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"><option value="">Không có</option>@for(t of teachers(); track t){<option [value]="t">{{t}}</option>}</select>
          </div>
          <div>
            <label for="chairperson-g45" class="block text-sm font-medium leading-6 text-gray-900">Chủ tọa (Tổ trưởng)</label>
            <select id="chairperson-g45" formControlName="chairperson" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"><option value="" disabled>Chọn</option>@for(t of teachers(); track t){<option [value]="t">{{t}}</option>}</select>
          </div>
          <div>
            <label for="secretary-g45" class="block text-sm font-medium leading-6 text-gray-900">Thư ký</label>
            <select id="secretary-g45" formControlName="secretary" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"><option value="" disabled>Chọn</option>@for(t of teachers(); track t){<option [value]="t">{{t}}</option>}</select>
          </div>
          <div>
            <label for="totalMembers-g45" class="block text-sm font-medium leading-6 text-gray-900">Tổng số thành viên</label>
            <input type="number" id="totalMembers-g45" formControlName="totalMembers" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300">
          </div>
          <div>
            <label for="presentMembers-g45" class="block text-sm font-medium leading-6 text-gray-900">Số thành viên có mặt</label>
            <input type="number" id="presentMembers-g45" formControlName="presentMembers" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300">
          </div>
          <div>
            <label for="absentMembers-g45" class="block text-sm font-medium leading-6 text-gray-900">Số thành viên vắng</label>
            <input type="number" id="absentMembers-g45" formControlName="absentMembers" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300">
          </div>
        </div>
      }
    </div>

    <!-- Section: Content -->
     <div class="rounded-lg bg-white shadow-sm overflow-hidden border">
       <button type="button" (click)="toggleSection('content')" class="w-full flex justify-between items-center p-3 text-left bg-gradient-to-r from-indigo-50 via-purple-50 to-pink-50 hover:from-indigo-100 transition-colors focus:outline-none">
        <h3 class="text-sm font-bold uppercase tracking-wider text-indigo-800">II. Nội dung</h3>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform duration-300 text-indigo-600" [class.rotate-180]="!sections().content" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
      </button>
      @if (sections().content) {
        <div class="p-6 border-t animate-fade-in-down space-y-6">
          <fieldset>
            <legend class="text-md font-semibold text-gray-900">1. Báo cáo tình hình thực hiện 2 tuần qua (Ưu điểm)</legend>
            <div class="mt-4 space-y-4">
              <div>
                <label for="reportPolitical-g45" class="block text-sm font-medium leading-6 text-gray-900">Công tác chính trị tư tưởng:</label>
                <textarea id="reportPolitical-g45" formControlName="reportPolitical" rows="3" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"></textarea>
              </div>
              <div>
                <label for="reportProfessional-g45" class="block text-sm font-medium leading-6 text-gray-900">Công tác chuyên môn:</label>
                <textarea id="reportProfessional-g45" formControlName="reportProfessional" rows="3" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"></textarea>
              </div>
            </div>
          </fieldset>
          <fieldset>
            <legend class="text-md font-semibold text-gray-900">2. Phương hướng hoạt động 2 tuần tới</legend>
             <div class="mt-4 space-y-4">
              <div>
                <label for="planPolitical-g45" class="block text-sm font-medium leading-6 text-gray-900">2.1. Công tác chính trị tư tưởng:</label>
                <textarea id="planPolitical-g45" formControlName="planPolitical" rows="3" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"></textarea>
              </div>
              <div>
                <label for="planDocuments-g45" class="block text-sm font-medium leading-6 text-gray-900">2.2. Triển khai các văn bản của cấp trên:</label>
                <textarea id="planDocuments-g45" formControlName="planDocuments" rows="3" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"></textarea>
              </div>
               <div>
                <label for="planHoChiMinh-g45" class="block text-sm font-medium leading-6 text-gray-900">3. Học tập làm theo tấm gương đạo đức Hồ Chí Minh:</label>
                <textarea id="planHoChiMinh-g45" formControlName="planHoChiMinh" rows="3" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"></textarea>
              </div>
               <div>
                <label for="planPublicRelations-g45" class="block text-sm font-medium leading-6 text-gray-900">4. Dân vận khéo:</label>
                <textarea id="planPublicRelations-g45" formControlName="planPublicRelations" rows="3" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"></textarea>
              </div>
               <div>
                <label for="planProfessional-g45" class="block text-sm font-medium leading-6 text-gray-900">5. Công tác chuyên môn:</label>
                <textarea id="planProfessional-g45" formControlName="planProfessional" rows="3" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"></textarea>
              </div>
               <div>
                <label for="contributions-g45" class="block text-sm font-medium leading-6 text-gray-900">6. Các ý kiến đóng góp:</label>
                <textarea id="contributions-g45" formControlName="contributions" rows="3" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"></textarea>
              </div>
               <div>
                <label for="leaderComments-g45" class="block text-sm font-medium leading-6 text-gray-900">7. Phát biểu của lãnh đạo tham dự:</label>
                <textarea id="leaderComments-g45" formControlName="leaderComments" rows="3" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"></textarea>
              </div>
               <div>
                <label for="conclusion-g45" class="block text-sm font-medium leading-6 text-gray-900">8. Kết luận:</label>
                <textarea id="conclusion-g45" formControlName="conclusion" rows="3" class="mt-1 block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300"></textarea>
              </div>
            </div>
          </fieldset>
        </div>
      }
    </div>

    <!-- Section: Signatures -->
    <div class="rounded-lg bg-white shadow-sm overflow-hidden border">
       <button type="button" (click)="toggleSection('signatures')" class="w-full flex justify-between items-center p-3 text-left bg-gradient-to-r from-indigo-50 via-purple-50 to-pink-50 hover:from-indigo-100 transition-colors focus:outline-none">
        <h3 class="text-sm font-bold uppercase tracking-wider text-indigo-800">Ký tên</h3>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform duration-300 text-indigo-600" [class.rotate-180]="!sections().signatures" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
      </button>
      @if (sections().signatures) {
        <div class="p-6 border-t animate-fade-in-down grid grid-cols-1 sm:grid-cols-2 gap-6 text-center">
            <div>
              <h4 class="font-bold">Tổ trưởng</h4>
              <p class="text-xs italic mb-2">(Ký, ghi rõ họ tên)</p>
              <app-signature-input formControlName="headSignature"></app-signature-input>
            </div>
            <div>
              <h4 class="font-bold">Thư ký</h4>
              <p class="text-xs italic mb-2">(Ký, ghi rõ họ tên)</p>
              <app-signature-input formControlName="secretarySignature"></app-signature-input>
            </div>
        </div>
      }
    </div>

    <div class="flex items-center justify-end pt-4">
      <button type="submit" class="rounded-md bg-indigo-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500">Lưu thay đổi</button>
    </div>
  </form>
</div>
